<!DOCTYPE HTML>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Publishing Rust types to a TypeScript frontend</title>
    <meta name="description" content="Common libraries and projects used to share types from a Rust web backend to a TypeScript frontend" />
    <link rel="alternate" type="application/rss+xml" href="/rss.xml" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <style>html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,footer,header,nav,section{display:block}h1{font-size:2em;margin:0.67em 0}figcaption,figure,main{display:block}hr{box-sizing:content-box;height:0;overflow:visible}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}address{font-style:normal}b,strong{font-weight:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:"SF Mono","Segoe UI Mono","Roboto Mono",Menlo,Courier,monospace;font-size:1em}dfn{font-style:italic}small{font-size:80%;font-weight:400}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-0.25em}sup{top:-0.5em}audio,video{display:inline-block}audio:not([controls]){display:none;height:0}img{border-style:none}svg:not(:root){overflow:hidden}button,input,optgroup,select,textarea{font-family:inherit;font-size:inherit;line-height:inherit;margin:0}button,input{overflow:visible}button,select{text-transform:none}button,html [type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0}fieldset{border:0;margin:0;padding:0}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{display:inline-block;vertical-align:baseline}textarea{overflow:auto}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px}[type="search"]::-webkit-search-cancel-button,[type="search"]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details,menu{display:block}summary{display:list-item;outline:none}canvas{display:inline-block}template{display:none}[hidden]{display:none}*,*::before,*::after{box-sizing:inherit}html{box-sizing:border-box;font-size:20px;line-height:1.5;-webkit-tap-highlight-color:transparent}body{background:#303742;color:#fff;font-family:-apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;font-size:.8rem;overflow-x:hidden;text-rendering:optimizeLegibility}a{color:#73c6ec;outline:none;text-decoration:none}a:focus{box-shadow:0 0 0 0.1rem rgba(115,198,236,0.2)}a:focus,a:hover,a:active,a.active{color:#46b4e6;text-decoration:underline}a:visited{color:#a0d8f2}h1,h2,h3,h4,h5,h6{color:inherit;font-weight:700;line-height:1.2;margin-bottom:.5rem;margin-top:0}.h1,.h2,.h3,.h4,.h5,.h6{font-weight:700}h1,.h1{font-size:2rem}h2,.h2{font-size:1.6rem}h3,.h3{font-size:1.4rem}h4,.h4{font-size:1.2rem}h5,.h5{font-size:1rem}h6,.h6{font-size:.8rem}p{margin:0 0 1.2rem}a,ins,u{text-decoration-skip:ink edges}abbr[title]{border-bottom:.05rem dotted;cursor:help;text-decoration:none}kbd{border-radius:.1rem;line-height:1.2;padding:.1rem .2rem;background:#303742;color:#fff;font-size:.7rem}mark{background:#ffe9b3;color:#fff;border-bottom:.05rem solid #ffd367;border-radius:.1rem;padding:.05rem .1rem 0}blockquote{border-left:.1rem solid #dadee4;margin-left:0;padding:.4rem .8rem}blockquote p:last-child{margin-bottom:0}ul,ol{margin:.8rem 0 .8rem .8rem;padding:0}ul ul,ul ol,ol ul,ol ol{margin:.8rem 0 .8rem .8rem}ul li,ol li{margin-top:.4rem}ul{list-style:disc inside}ul ul{list-style-type:circle}ol{list-style:decimal inside}ol ol{list-style-type:lower-alpha}dl dt{font-weight:bold}dl dd{margin:.4rem 0 .8rem 0}.btn{appearance:none;background:#fff;border:.05rem solid #73c6ec;border-radius:.1rem;color:#73c6ec;cursor:pointer;display:inline-block;font-size:.8rem;height:2.5rem;line-height:1.2rem;outline:none;padding:.6rem .4rem;text-align:center;text-decoration:none;transition:background .2s, border .2s, box-shadow .2s, color .2s;user-select:none;vertical-align:middle;white-space:nowrap}.btn:focus{box-shadow:0 0 0 0.1rem rgba(115,198,236,0.2)}.btn:focus,.btn:hover{background:#fff;border-color:#66c1ea;text-decoration:none}.btn:active,.btn.active{background:#66c1ea;border-color:#4fb7e7;color:#fff;text-decoration:none}.btn.loading:active::after,.btn.active.loading::after{border-bottom-color:#fff;border-left-color:#fff}.btn[disabled],.btn:disabled,.btn.disabled{cursor:default;opacity:.5;pointer-events:none}.btn.btn-primary{background:#73c6ec;border-color:#66c1ea;color:#fff}.btn.btn-primary:focus,.btn.btn-primary:hover{background:#5dbde9;border-color:#4fb7e7;color:#fff}.btn.btn-primary:active,.btn.btn-primary.active{background:#54b9e8;border-color:#46b4e6;color:#fff}.btn.btn-primary.loading::after{border-bottom-color:#fff;border-left-color:#fff}.btn.btn-success{background:#32b643;border-color:#2faa3f;color:#fff}.btn.btn-success:focus{box-shadow:0 0 0 0.1rem rgba(50,182,67,0.2)}.btn.btn-success:focus,.btn.btn-success:hover{background:#30ae40;border-color:#2da23c;color:#fff}.btn.btn-success:active,.btn.btn-success.active{background:#2a9a39;border-color:#278e34;color:#fff}.btn.btn-success.loading::after{border-bottom-color:#fff;border-left-color:#fff}.btn.btn-error{background:#e85600;border-color:#d95000;color:#fff}.btn.btn-error:focus{box-shadow:0 0 0 0.1rem rgba(232,86,0,0.2)}.btn.btn-error:focus,.btn.btn-error:hover{background:#de5200;border-color:#cf4d00;color:#fff}.btn.btn-error:active,.btn.btn-error.active{background:#c44900;border-color:#b54300;color:#fff}.btn.btn-error.loading::after{border-bottom-color:#fff;border-left-color:#fff}.btn.btn-link{background:transparent;border-color:transparent;color:#73c6ec}.btn.btn-link:focus,.btn.btn-link:hover,.btn.btn-link:active,.btn.btn-link.active{color:#46b4e6}.btn.btn-sm{font-size:.7rem;height:1.4rem;padding:.05rem .3rem}.btn.btn-lg{font-size:.9rem;height:2rem;padding:.35rem .6rem}.btn.btn-block{display:block;width:100%}.btn.btn-action{width:2.5rem;padding-left:0;padding-right:0}.btn.btn-action.btn-sm{width:1.4rem}.btn.btn-action.btn-lg{width:2rem}.btn.btn-clear{background:transparent;border:0;color:currentColor;height:1rem;line-height:.8rem;margin-left:.2rem;margin-right:-2px;opacity:1;padding:.1rem;text-decoration:none;width:1rem}.btn.btn-clear:focus,.btn.btn-clear:hover{background:rgba(48,55,66,0.5);opacity:.95}.btn.btn-clear::before{content:"\2715"}.btn-group{display:inline-flex;flex-wrap:wrap}.btn-group .btn{flex:1 0 auto}.btn-group .btn:first-child:not(:last-child){border-bottom-right-radius:0;border-top-right-radius:0}.btn-group .btn:not(:first-child):not(:last-child){border-radius:0;margin-left:-.05rem}.btn-group .btn:last-child:not(:first-child){border-bottom-left-radius:0;border-top-left-radius:0;margin-left:-.05rem}.btn-group .btn:focus,.btn-group .btn:hover,.btn-group .btn:active,.btn-group .btn.active{z-index:1}.btn-group.btn-group-block{display:flex}.btn-group.btn-group-block .btn{flex:1 0 0}.label{border-radius:.1rem;line-height:1.2;padding:.1rem .2rem;background:#39414e;color:#e6e6e6;display:inline-block}.label.label-rounded{border-radius:5rem;padding-left:.4rem;padding-right:.4rem}.label.label-primary{background:#0b3e55;color:#fff}.label.label-secondary{background:#fff;color:#73c6ec}.label.label-success{background:#32b643;color:#fff}.label.label-warning{background:#ffb700;color:#fff}.label.label-error{background:#e85600;color:#fff}p code{border-radius:.1rem;line-height:1.2;padding:.1rem .2rem;background:#0f4e6b;color:#fff;font-size:85%}.code{border-radius:.1rem;color:#fff;position:relative}.code::before{color:#bcc3ce;content:attr(data-lang);font-size:.7rem;position:absolute;right:.4rem;top:.1rem}.code code{background:#303742;color:inherit;display:block;line-height:1.5;overflow-x:auto;padding:1rem;width:100%}.container{margin-left:auto;margin-right:auto;padding-left:.4rem;padding-right:.4rem;width:100%}.container.grid-xl{max-width:1296px}.container.grid-lg{max-width:976px}.container.grid-md{max-width:856px}.container.grid-sm{max-width:616px}.container.grid-xs{max-width:496px}.show-xs,.show-sm,.show-md,.show-lg,.show-xl{display:none !important}.columns{display:flex;flex-wrap:wrap;margin-left:-.4rem;margin-right:-.4rem}.columns.col-gapless{margin-left:0;margin-right:0}.columns.col-gapless>.column{padding-left:0;padding-right:0}.columns.col-oneline{flex-wrap:nowrap;overflow-x:auto}.column{flex:1;max-width:100%;padding-left:.4rem;padding-right:.4rem}.column.col-12,.column.col-11,.column.col-10,.column.col-9,.column.col-8,.column.col-7,.column.col-6,.column.col-5,.column.col-4,.column.col-3,.column.col-2,.column.col-1{flex:none}.col-12{width:100%}.col-11{width:91.66666667%}.col-10{width:83.33333333%}.col-9{width:75%}.col-8{width:66.66666667%}.col-7{width:58.33333333%}.col-6{width:50%}.col-5{width:41.66666667%}.col-4{width:33.33333333%}.col-3{width:25%}.col-2{width:16.66666667%}.col-1{width:8.33333333%}.col-auto{flex:0 0 auto;max-width:none;width:auto}.col-mx-auto{margin-left:auto;margin-right:auto}.col-ml-auto{margin-left:auto}.col-mr-auto{margin-right:auto}@media (max-width: 1280px){.col-xl-12,.col-xl-11,.col-xl-10,.col-xl-9,.col-xl-8,.col-xl-7,.col-xl-6,.col-xl-5,.col-xl-4,.col-xl-3,.col-xl-2,.col-xl-1{flex:none}.col-xl-12{width:100%}.col-xl-11{width:91.66666667%}.col-xl-10{width:83.33333333%}.col-xl-9{width:75%}.col-xl-8{width:66.66666667%}.col-xl-7{width:58.33333333%}.col-xl-6{width:50%}.col-xl-5{width:41.66666667%}.col-xl-4{width:33.33333333%}.col-xl-3{width:25%}.col-xl-2{width:16.66666667%}.col-xl-1{width:8.33333333%}.hide-xl{display:none !important}.show-xl{display:block !important}}@media (max-width: 960px){.col-lg-12,.col-lg-11,.col-lg-10,.col-lg-9,.col-lg-8,.col-lg-7,.col-lg-6,.col-lg-5,.col-lg-4,.col-lg-3,.col-lg-2,.col-lg-1{flex:none}.col-lg-12{width:100%}.col-lg-11{width:91.66666667%}.col-lg-10{width:83.33333333%}.col-lg-9{width:75%}.col-lg-8{width:66.66666667%}.col-lg-7{width:58.33333333%}.col-lg-6{width:50%}.col-lg-5{width:41.66666667%}.col-lg-4{width:33.33333333%}.col-lg-3{width:25%}.col-lg-2{width:16.66666667%}.col-lg-1{width:8.33333333%}.hide-lg{display:none !important}.show-lg{display:block !important}}@media (max-width: 840px){.col-md-12,.col-md-11,.col-md-10,.col-md-9,.col-md-8,.col-md-7,.col-md-6,.col-md-5,.col-md-4,.col-md-3,.col-md-2,.col-md-1{flex:none}.col-md-12{width:100%}.col-md-11{width:91.66666667%}.col-md-10{width:83.33333333%}.col-md-9{width:75%}.col-md-8{width:66.66666667%}.col-md-7{width:58.33333333%}.col-md-6{width:50%}.col-md-5{width:41.66666667%}.col-md-4{width:33.33333333%}.col-md-3{width:25%}.col-md-2{width:16.66666667%}.col-md-1{width:8.33333333%}.hide-md{display:none !important}.show-md{display:block !important}}@media (max-width: 600px){.col-sm-12,.col-sm-11,.col-sm-10,.col-sm-9,.col-sm-8,.col-sm-7,.col-sm-6,.col-sm-5,.col-sm-4,.col-sm-3,.col-sm-2,.col-sm-1{flex:none}.col-sm-12{width:100%}.col-sm-11{width:91.66666667%}.col-sm-10{width:83.33333333%}.col-sm-9{width:75%}.col-sm-8{width:66.66666667%}.col-sm-7{width:58.33333333%}.col-sm-6{width:50%}.col-sm-5{width:41.66666667%}.col-sm-4{width:33.33333333%}.col-sm-3{width:25%}.col-sm-2{width:16.66666667%}.col-sm-1{width:8.33333333%}.hide-sm{display:none !important}.show-sm{display:block !important}}@media (max-width: 480px){.col-xs-12,.col-xs-11,.col-xs-10,.col-xs-9,.col-xs-8,.col-xs-7,.col-xs-6,.col-xs-5,.col-xs-4,.col-xs-3,.col-xs-2,.col-xs-1{flex:none}.col-xs-12{width:100%}.col-xs-11{width:91.66666667%}.col-xs-10{width:83.33333333%}.col-xs-9{width:75%}.col-xs-8{width:66.66666667%}.col-xs-7{width:58.33333333%}.col-xs-6{width:50%}.col-xs-5{width:41.66666667%}.col-xs-4{width:33.33333333%}.col-xs-3{width:25%}.col-xs-2{width:16.66666667%}.col-xs-1{width:8.33333333%}.hide-xs{display:none !important}.show-xs{display:block !important}}.navbar{align-items:stretch;display:flex;flex-wrap:wrap;justify-content:space-between;margin-left:auto;margin-right:auto;max-width:960px}.navbar .navbar-section{align-items:center;display:flex;flex:1 0 0}.navbar .navbar-section:not(:first-child):last-child{justify-content:flex-end}.navbar .navbar-center{align-items:center;display:flex;flex:0 0 auto}.navbar .navbar-brand{font-size:.9rem;text-decoration:none}pre{padding:0.5rem 0.5rem;border-radius:.3rem;overflow-y:auto}.post header{border-radius:.3rem;padding:0.5rem;margin-bottom:0.5rem}.post header h1{margin-bottom:0}.post section{padding:0.5rem;background-color:#2a3039;border-radius:.3rem}.post img{width:100%}.post .utterances{max-width:none !important}.card{margin-bottom:0.5rem}.main-header{margin-bottom:0.5rem;background-color:#272d36;box-shadow:0 20rem 20rem 20rem rgba(115,198,236,0.2)}.card{background:#2a3039;border-radius:.3rem;display:flex;flex-direction:column}.card .card-header,.card .card-body,.card .card-footer{padding:.8rem;padding-bottom:0}.card .card-header:last-child,.card .card-body:last-child,.card .card-footer:last-child{padding-bottom:.8rem}.card .card-body{flex:1 1 auto}.card .card-image{padding-top:.8rem}.card .card-image:first-child{padding-top:0}.card .card-image:first-child img{border-top-left-radius:.1rem;border-top-right-radius:.1rem}.card .card-image:last-child img{border-bottom-left-radius:.1rem;border-bottom-right-radius:.1rem}
</style>
</head>

<body>
    <header class="main-header">
        <div class="navbar">
        <section class="navbar-section">
            <img src="/favicon.svg" width="30" height="30"/>
            <a href="/" class="btn btn-link">Home</a>
            <a href="/blog/" class="btn btn-link">Blogs</a>
            <a href="/rss.xml" class="btn btn-link">RSS</a>
        </section>
        <section class="navbar-center">
        </section>
        <section class="navbar-section">
            <a href="https://github.com/cetra3/" class="btn btn-link">GitHub</a>
            <a href="https://twitter.com/cetra3" class="btn btn-link">Twitter</a>
            <a href="https://mastodon.social/@cetra3" class="btn btn-link">Mastodon</a>
        </section>
        </div>
    </header>
    <div class="container grid-lg">
        
<article class="post">
  <header>
  <h1>Publishing Rust types to a TypeScript frontend </h1>
  <em>Common libraries and projects used to share types from a Rust web backend to a TypeScript frontend</em>
  <br />
  
  <small class="label label-primary">rust</small> <small class="label label-primary">typescript</small> <small class="label">2022-09-13</small>
  
  </header>
  <section>
    <p>When building in a strongly-typed language such as rust it's a shame to have to throw this strictness away, <strong>especially</strong> when dealing with the wild west of frontend stacks. The bigger the project is, the more you want to keep things cohesive.</p>
<p>This cohesion evaporates quickly when you need to pass language barriers. While normal JavaScript does not have types, we can utilise <a href="https://www.typescriptlang.org/">TypeScript</a> to share this type information and hopefully maintain some cohesion between languages.</p>
<p>The scenario we're targeting here is writing a web backend in rust, and having those types/methods available easily for a <code>TypeScript</code> enabled frontend. This article describes a few common methods we can bridge the two languages together using currently available tools and libraries. Most of them follow similar characteristics, but each approach has their own set of tradeoffs.</p>
<p>This blog will primarily use <a href="https://actix.rs/"><code>actix-web</code></a> as the example for the web backend, as it is one I'm most familiar with, but the libraries used here do have support for other backends.</p>
<h2 id="derive-macros">Derive Macros</h2>
<p>Strictly speaking, all these methods use derive macros in some way, but what I am describing here is using derive macros to publish structs/objects as typescript definitions. These don't include function/methods or http requests (which will be discussed later on).</p>
<p>Rust does not have runtime reflection built into the language &amp; so relies on decorating types via macros to provide some sort of approximate &quot;reflection&quot;.</p>
<p>In terms of the two main derive macro libraries to choose from, we have <a href="https://crates.io/crates/ts-rs"><code>ts-rs</code></a> and <a href="https://crates.io/crates/schemars"><code>schemars</code></a>. Both of these libraries are integrated tightly with <code>serde</code>.</p>
<h3 id="ts-rs">ts-rs</h3>
<p>The <a href="https://crates.io/crates/ts-rs"><code>ts-rs</code></a> library will allow you to output typescript types for your existing objects:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">derive</span><span>(TS)]
</span><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">ts</span><span>(export)]
</span><span style="color:#ffa759;">struct </span><span style="color:#73d0ff;">User </span><span>{
</span><span>    user_id</span><span style="color:#ccc9c2cc;">: </span><span style="color:#ffa759;">i32</span><span>,
</span><span>    first_name</span><span style="color:#ccc9c2cc;">:</span><span> String,
</span><span>    last_name</span><span style="color:#ccc9c2cc;">:</span><span> String,
</span><span>}
</span></code></pre>
<p>The <code>#[ts(export)]</code> attribute will export this type when you run <code>cargo test</code> on your crate.</p>
<p>By default this will be in the <code>bindings/</code> directory, with a separate typescript file per object type:</p>
<pre data-lang="typescript" style="background-color:#212733;color:#ccc9c2;" class="language-typescript "><code class="language-typescript" data-lang="typescript"><span style="color:#ffa759;">export interface </span><span style="color:#73d0ff;">User </span><span>{
</span><span>  user_id</span><span style="color:#f29e74;">: </span><span style="font-style:italic;color:#5ccfe6;">number</span><span style="color:#ccc9c2cc;">;
</span><span>  first_name</span><span style="color:#f29e74;">: </span><span style="font-style:italic;color:#5ccfe6;">string</span><span style="color:#ccc9c2cc;">;
</span><span>  last_name</span><span style="color:#f29e74;">: </span><span style="font-style:italic;color:#5ccfe6;">string</span><span style="color:#ccc9c2cc;">;
</span><span>}
</span></code></pre>
<p>Alternatively, you can use the <a href="https://docs.rs/ts-rs/6.2.0/ts_rs/trait.TS.html"><code>TS::decl()</code></a> method to export it as a <code>String</code>.</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">main</span><span>() {
</span><span>    </span><span style="color:#f28779;">println!</span><span>(</span><span style="color:#bae67e;">&quot;</span><span style="color:#ffcc66;">{}</span><span style="color:#bae67e;">&quot;</span><span style="color:#ccc9c2cc;">, </span><span>User</span><span style="color:#f29e74;">::</span><span>decl())</span><span style="color:#ccc9c2cc;">;
</span><span>}
</span></code></pre>
<h3 id="schemars">schemars</h3>
<p>Now, <a href="https://crates.io/crates/schemars"><code>schemars</code></a> does not export to typescript directly, but will export to <a href="http://json-schema.org/">JSON Schema</a> which can be consumed &amp; converted into typescript with the help of <a href="https://github.com/bcherny/json-schema-to-typescript">conversion tools</a>.</p>
<p>Working similar to <code>ts-rs</code>, you can derive <code>JsonSchema</code> on your objects:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">derive</span><span>(JsonSchema)]
</span><span style="color:#ffa759;">struct </span><span style="color:#73d0ff;">User </span><span>{
</span><span>    user_id</span><span style="color:#ccc9c2cc;">: </span><span style="color:#ffa759;">i32</span><span>,
</span><span>    first_name</span><span style="color:#ccc9c2cc;">:</span><span> String,
</span><span>    last_name</span><span style="color:#ccc9c2cc;">:</span><span> String,
</span><span>}
</span></code></pre>
<p>From there, you can print out the schema with the help the <code>schema_for</code> macro &amp; <code>serde_json</code>:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">main</span><span>() {
</span><span>    </span><span style="color:#ffa759;">let</span><span> schema </span><span style="color:#f29e74;">= </span><span style="color:#f28779;">schema_for!</span><span>(User)</span><span style="color:#ccc9c2cc;">;
</span><span>    </span><span style="color:#f28779;">println!</span><span>(</span><span style="color:#bae67e;">&quot;</span><span style="color:#ffcc66;">{}</span><span style="color:#bae67e;">&quot;</span><span style="color:#ccc9c2cc;">, </span><span>serde_json</span><span style="color:#f29e74;">::</span><span>to_string_pretty(</span><span style="color:#f29e74;">&amp;</span><span>schema)</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">unwrap</span><span>())</span><span style="color:#ccc9c2cc;">;
</span><span>}
</span></code></pre>
<p>With this schema in hand, you can use a tool like <a href="https://github.com/bcherny/json-schema-to-typescript"><code>json-schema-to-typescript</code></a> to output it as typescript types:</p>
<pre data-lang="sh" style="background-color:#212733;color:#ccc9c2;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#ffd580;">$</span><span> cargo run </span><span style="color:#f29e74;">| </span><span style="color:#ffd580;">npx</span><span> json-schema-to-typescript
</span></code></pre>
<pre data-lang="typescript" style="background-color:#212733;color:#ccc9c2;" class="language-typescript "><code class="language-typescript" data-lang="typescript"><span style="font-style:italic;color:#5c6773;">/* tslint:disable */
</span><span style="font-style:italic;color:#5c6773;">/**
</span><span style="font-style:italic;color:#5c6773;"> * This file was automatically generated by json-schema-to-typescript.
</span><span style="font-style:italic;color:#5c6773;"> * DO NOT MODIFY IT BY HAND. Instead, modify the source JSONSchema file,
</span><span style="font-style:italic;color:#5c6773;"> * and run json-schema-to-typescript to regenerate this file.
</span><span style="font-style:italic;color:#5c6773;"> */
</span><span>
</span><span style="color:#ffa759;">export interface </span><span style="color:#73d0ff;">User </span><span>{
</span><span>  first_name</span><span style="color:#f29e74;">: </span><span style="font-style:italic;color:#5ccfe6;">string</span><span style="color:#ccc9c2cc;">;
</span><span>  last_name</span><span style="color:#f29e74;">: </span><span style="font-style:italic;color:#5ccfe6;">string</span><span style="color:#ccc9c2cc;">;
</span><span>  user_id</span><span style="color:#f29e74;">: </span><span style="font-style:italic;color:#5ccfe6;">number</span><span style="color:#ccc9c2cc;">;
</span><span>  [</span><span style="color:#ffcc66;">k</span><span style="color:#f29e74;">: </span><span style="font-style:italic;color:#5ccfe6;">string</span><span>]</span><span style="color:#f29e74;">: </span><span style="font-style:italic;color:#5ccfe6;">unknown</span><span style="color:#ccc9c2cc;">;
</span><span>}
</span></code></pre>
<h2 id="openapi-generators">OpenAPI Generators</h2>
<p>While straight derive macros are great at defining types, you sometimes also want some type safety around the methods used. If your backend is a web server, it's great to auto-generate the appropriate typescript code for making HTTP API calls. Luckily, if you can generate an <a href="https://spec.openapis.org/oas/v3.1.0">OpenAPI spec</a>, you can auto-generate clients for use in the frontend, all typed and ready to go!</p>
<p>Depending on your backend web framework will dictate what support there are for this method. There is a push for the most common web frameworks to have OpenAPI support with varying states of maturity.</p>
<h3 id="paperclip-and-actix-web">Paperclip and Actix Web</h3>
<p>This method is one I am most familiar with, using <a href="https://crates.io/crates/paperclip"><code>paperclip</code></a> with an <a href="https://crates.io/crates/actix-web"><code>actix-web</code></a> backend. The <a href="https://crates.io/crates/paperclip"><code>paperclip</code></a> crate allows you to annotate structs &amp; request methods to have it auto-generate an OpenAPI spec for you:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ffa759;">use </span><span>actix_web</span><span style="color:#f29e74;">::</span><span>{App</span><span style="color:#ccc9c2cc;">,</span><span> Error</span><span style="color:#ccc9c2cc;">,</span><span> HttpServer}</span><span style="color:#ccc9c2cc;">;
</span><span style="color:#ffa759;">use </span><span>paperclip</span><span style="color:#f29e74;">::</span><span>actix</span><span style="color:#f29e74;">::</span><span>{
</span><span>    api_v2_operation</span><span style="color:#ccc9c2cc;">,
</span><span>    web</span><span style="color:#f29e74;">::</span><span>{</span><span style="font-style:italic;color:#5ccfe6;">self</span><span style="color:#ccc9c2cc;">,</span><span> Json}</span><span style="color:#ccc9c2cc;">,
</span><span>    Apiv2Schema</span><span style="color:#ccc9c2cc;">,</span><span> OpenApiExt</span><span style="color:#ccc9c2cc;">,
</span><span>}</span><span style="color:#ccc9c2cc;">;
</span><span style="color:#ffa759;">use </span><span>serde</span><span style="color:#f29e74;">::</span><span>{Deserialize</span><span style="color:#ccc9c2cc;">,</span><span> Serialize}</span><span style="color:#ccc9c2cc;">;
</span><span>
</span><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">derive</span><span>(Serialize</span><span style="color:#ccc9c2cc;">,</span><span> Deserialize</span><span style="color:#ccc9c2cc;">,</span><span> Apiv2Schema)]
</span><span style="color:#ffa759;">struct </span><span style="color:#73d0ff;">User </span><span>{
</span><span>    user_id</span><span style="color:#ccc9c2cc;">: </span><span style="color:#ffa759;">i32</span><span>,
</span><span>    first_name</span><span style="color:#ccc9c2cc;">:</span><span> String,
</span><span>    last_name</span><span style="color:#ccc9c2cc;">:</span><span> String,
</span><span>}
</span><span>
</span><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">api_v2_operation</span><span>]
</span><span>async </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">echo_user</span><span>(</span><span style="color:#ffcc66;">body</span><span style="color:#ccc9c2cc;">: </span><span>Json&lt;User&gt;) </span><span style="color:#ccc9c2cc;">-&gt; </span><span style="font-style:italic;color:#5ccfe6;">Result</span><span>&lt;Json&lt;User&gt;, Error&gt; {
</span><span>    </span><span style="font-style:italic;color:#5ccfe6;">Ok</span><span>(body)
</span><span>}
</span><span>
</span><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">actix_web</span><span>::</span><span style="color:#ffd580;">main</span><span>]
</span><span>async </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">main</span><span>() </span><span style="color:#ccc9c2cc;">-&gt; </span><span>std</span><span style="color:#f29e74;">::</span><span>io</span><span style="color:#f29e74;">::</span><span style="font-style:italic;color:#5ccfe6;">Result</span><span>&lt;()&gt; {
</span><span>    HttpServer</span><span style="color:#f29e74;">::</span><span>new(|| {
</span><span>        App</span><span style="color:#f29e74;">::</span><span>new()
</span><span>            </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">wrap_api</span><span>()
</span><span>            </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">service</span><span>(web</span><span style="color:#f29e74;">::</span><span>resource(</span><span style="color:#bae67e;">&quot;/echo&quot;</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">route</span><span>(web</span><span style="color:#f29e74;">::</span><span>post()</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">to</span><span>(echo_user)))
</span><span>            </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">with_json_spec_v3_at</span><span>(</span><span style="color:#bae67e;">&quot;/api/spec/v3&quot;</span><span>)
</span><span>            </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">build</span><span>()
</span><span>    })
</span><span>    </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">bind</span><span>(</span><span style="color:#bae67e;">&quot;127.0.0.1:8080&quot;</span><span>)</span><span style="color:#f29e74;">?
</span><span>    </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">run</span><span>()
</span><span>    </span><span style="color:#f29e74;">.</span><span>await
</span><span>}
</span></code></pre>
<p>Now, you can curl to retrieve the json spec:</p>
<pre data-lang="sh" style="background-color:#212733;color:#ccc9c2;" class="language-sh "><code class="language-sh" data-lang="sh"><span style="color:#ffd580;">curl</span><span> http://127.0.0.1:8080/api/spec/v3
</span></code></pre>
<pre data-lang="json" style="background-color:#212733;color:#ccc9c2;" class="language-json "><code class="language-json" data-lang="json"><span>{
</span><span>  </span><span style="color:#bae67e;">&quot;openapi&quot;</span><span style="color:#ccc9c2cc;">: </span><span style="color:#bae67e;">&quot;3.0.0&quot;</span><span style="color:#ccc9c2cc;">,
</span><span>  </span><span style="color:#bae67e;">&quot;info&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{ </span><span style="color:#bae67e;">&quot;title&quot;</span><span style="color:#ccc9c2cc;">: </span><span style="color:#bae67e;">&quot;&quot;</span><span style="color:#ccc9c2cc;">, </span><span style="color:#bae67e;">&quot;version&quot;</span><span style="color:#ccc9c2cc;">: </span><span style="color:#bae67e;">&quot;&quot; </span><span>}</span><span style="color:#ccc9c2cc;">,
</span><span>  </span><span style="color:#bae67e;">&quot;paths&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{
</span><span>    </span><span style="color:#bae67e;">&quot;/echo&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{
</span><span>      </span><span style="color:#bae67e;">&quot;post&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{
</span><span>        </span><span style="color:#bae67e;">&quot;requestBody&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{
</span><span>          </span><span style="color:#bae67e;">&quot;content&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{
</span><span>            </span><span style="color:#bae67e;">&quot;application/json&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{
</span><span>              </span><span style="color:#bae67e;">&quot;schema&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{ </span><span style="color:#bae67e;">&quot;$ref&quot;</span><span style="color:#ccc9c2cc;">: </span><span style="color:#bae67e;">&quot;#/components/schemas/User&quot; </span><span>}
</span><span>            }
</span><span>          }</span><span style="color:#ccc9c2cc;">,
</span><span>          </span><span style="color:#bae67e;">&quot;required&quot;</span><span style="color:#ccc9c2cc;">: </span><span style="color:#ffcc66;">true
</span><span>        }</span><span style="color:#ccc9c2cc;">,
</span><span>        </span><span style="color:#bae67e;">&quot;responses&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{
</span><span>          </span><span style="color:#bae67e;">&quot;200&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{
</span><span>            </span><span style="color:#bae67e;">&quot;description&quot;</span><span style="color:#ccc9c2cc;">: </span><span style="color:#bae67e;">&quot;OK&quot;</span><span style="color:#ccc9c2cc;">,
</span><span>            </span><span style="color:#bae67e;">&quot;content&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{
</span><span>              </span><span style="color:#bae67e;">&quot;application/json&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{
</span><span>                </span><span style="color:#bae67e;">&quot;schema&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{ </span><span style="color:#bae67e;">&quot;$ref&quot;</span><span style="color:#ccc9c2cc;">: </span><span style="color:#bae67e;">&quot;#/components/schemas/User&quot; </span><span>}
</span><span>              }
</span><span>            }
</span><span>          }
</span><span>        }
</span><span>      }
</span><span>    }
</span><span>  }</span><span style="color:#ccc9c2cc;">,
</span><span>  </span><span style="color:#bae67e;">&quot;components&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{
</span><span>    </span><span style="color:#bae67e;">&quot;schemas&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{
</span><span>      </span><span style="color:#bae67e;">&quot;User&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{
</span><span>        </span><span style="color:#bae67e;">&quot;type&quot;</span><span style="color:#ccc9c2cc;">: </span><span style="color:#bae67e;">&quot;object&quot;</span><span style="color:#ccc9c2cc;">,
</span><span>        </span><span style="color:#bae67e;">&quot;properties&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{
</span><span>          </span><span style="color:#bae67e;">&quot;first_name&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{ </span><span style="color:#bae67e;">&quot;type&quot;</span><span style="color:#ccc9c2cc;">: </span><span style="color:#bae67e;">&quot;string&quot; </span><span>}</span><span style="color:#ccc9c2cc;">,
</span><span>          </span><span style="color:#bae67e;">&quot;last_name&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{ </span><span style="color:#bae67e;">&quot;type&quot;</span><span style="color:#ccc9c2cc;">: </span><span style="color:#bae67e;">&quot;string&quot; </span><span>}</span><span style="color:#ccc9c2cc;">,
</span><span>          </span><span style="color:#bae67e;">&quot;user_id&quot;</span><span style="color:#ccc9c2cc;">: </span><span>{ </span><span style="color:#bae67e;">&quot;type&quot;</span><span style="color:#ccc9c2cc;">: </span><span style="color:#bae67e;">&quot;integer&quot;</span><span style="color:#ccc9c2cc;">, </span><span style="color:#bae67e;">&quot;format&quot;</span><span style="color:#ccc9c2cc;">: </span><span style="color:#bae67e;">&quot;int32&quot; </span><span>}
</span><span>        }</span><span style="color:#ccc9c2cc;">,
</span><span>        </span><span style="color:#bae67e;">&quot;required&quot;</span><span style="color:#ccc9c2cc;">: </span><span>[</span><span style="color:#bae67e;">&quot;first_name&quot;</span><span style="color:#ccc9c2cc;">, </span><span style="color:#bae67e;">&quot;last_name&quot;</span><span style="color:#ccc9c2cc;">, </span><span style="color:#bae67e;">&quot;user_id&quot;</span><span>]
</span><span>      }
</span><span>    }
</span><span>  }
</span><span>}
</span></code></pre>
<p>However, if you're like me and would like it written out to a file rather than rely on a backend to be running, you can do so with a little bit of fiddling around.</p>
<p>Firstly, we want to create a function to configure our services:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">config</span><span>(</span><span style="color:#ffcc66;">cfg</span><span style="color:#ccc9c2cc;">: </span><span style="color:#f29e74;">&amp;</span><span style="color:#ffa759;">mut </span><span>web</span><span style="color:#f29e74;">::</span><span>ServiceConfig) {
</span><span>    cfg</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">service</span><span>(web</span><span style="color:#f29e74;">::</span><span>resource(</span><span style="color:#bae67e;">&quot;/echo&quot;</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">route</span><span>(web</span><span style="color:#f29e74;">::</span><span>post()</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">to</span><span>(echo_user)))</span><span style="color:#ccc9c2cc;">;
</span><span>}
</span></code></pre>
<p>Then we can adjust our main app to use this to configure actix web:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span>App</span><span style="color:#f29e74;">::</span><span>new()
</span><span>    </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">wrap_api</span><span>()
</span><span>    </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">configure</span><span>(config)
</span><span>    </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">with_json_spec_v3_at</span><span>(</span><span style="color:#bae67e;">&quot;/api/spec/v3&quot;</span><span>)
</span><span>    </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">build</span><span>()
</span></code></pre>
<p>And we can create another function that will write out the api spec to a file:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ffa759;">pub fn </span><span style="color:#ffd580;">dump_schema</span><span>&lt;P</span><span style="color:#ccc9c2cc;">: </span><span style="font-style:italic;color:#5ccfe6;">AsRef</span><span>&lt;Path&gt;&gt;(</span><span style="color:#ffcc66;">path</span><span style="color:#ccc9c2cc;">:</span><span> P) {
</span><span>    App</span><span style="color:#f29e74;">::</span><span>new()
</span><span>        </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">wrap_api</span><span>()
</span><span>        </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">configure</span><span>(config)
</span><span>        </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">with_raw_json_spec_v3</span><span>(|</span><span style="color:#ffcc66;">app</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffcc66;">spec</span><span>| {
</span><span>            </span><span style="color:#ffa759;">let mut</span><span> file </span><span style="color:#f29e74;">= </span><span>File</span><span style="color:#f29e74;">::</span><span>create(</span><span style="color:#f29e74;">&amp;</span><span>path)</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">expect</span><span>(</span><span style="color:#bae67e;">&quot;Could not create a file&quot;</span><span>)</span><span style="color:#ccc9c2cc;">;
</span><span>            file</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">write_all</span><span>(
</span><span>                serde_json</span><span style="color:#f29e74;">::</span><span>to_string_pretty(</span><span style="color:#f29e74;">&amp;</span><span>spec)
</span><span>                    </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">expect</span><span>(</span><span style="color:#bae67e;">&quot;Could not serialize spec&quot;</span><span>)
</span><span>                    </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">as_bytes</span><span>()</span><span style="color:#ccc9c2cc;">,
</span><span>            )
</span><span>            </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">expect</span><span>(</span><span style="color:#bae67e;">&quot;Could not write schema&quot;</span><span>)</span><span style="color:#ccc9c2cc;">;
</span><span>
</span><span>            app
</span><span>        })</span><span style="color:#ccc9c2cc;">;
</span><span>}
</span></code></pre>
<p>The reason we keep it separate from the main <code>App</code> builder inside the <code>HttpServer</code> closure is that the builder will be called per worker &amp; so as you can imagine it would write out the file multiple times on server startup.</p>
<p>Now we can call it manually:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#f28779;">dump_schema</span><span>(</span><span style="color:#bae67e;">&quot;openapi.json&quot;</span><span>)</span><span style="color:#ccc9c2cc;">;
</span></code></pre>
<h3 id="utoipa">Utoipa</h3>
<p>More general purpose and targeting a number of different web frameworks, the <a href="https://crates.io/crates/utoipa"><code>utoipa</code></a> library is similar in function to <code>paperclip</code>, albeit with a little bit more boilerplate to get going.</p>
<p>As before, a derive macro <code>ToSchema</code> handles the straight type magic:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">derive</span><span>(Serialize</span><span style="color:#ccc9c2cc;">,</span><span> Deserialize</span><span style="color:#ccc9c2cc;">,</span><span> ToSchema)]
</span><span style="color:#ffa759;">struct </span><span style="color:#73d0ff;">User </span><span>{
</span><span>    user_id</span><span style="color:#ccc9c2cc;">: </span><span style="color:#ffa759;">i32</span><span>,
</span><span>    first_name</span><span style="color:#ccc9c2cc;">:</span><span> String,
</span><span>    last_name</span><span style="color:#ccc9c2cc;">:</span><span> String,
</span><span>}
</span></code></pre>
<p>Decorating services is a little more cumbersome, as we need to specify the request &amp; response types alongside a status.</p>
<p>Here's an actix web example:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">utoipa</span><span>::</span><span style="color:#ffd580;">path</span><span>(post</span><span style="color:#ccc9c2cc;">,</span><span> request_body </span><span style="color:#f29e74;">=</span><span> User</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffd580;">responses</span><span>((status </span><span style="color:#f29e74;">=</span><span> 200</span><span style="color:#ccc9c2cc;">,</span><span> body </span><span style="color:#f29e74;">=</span><span> User)))]
</span><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">post</span><span>(</span><span style="color:#bae67e;">&quot;/echo&quot;</span><span>)]
</span><span>async </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">echo_user</span><span>(</span><span style="color:#ffcc66;">body</span><span style="color:#ccc9c2cc;">: </span><span>Json&lt;User&gt;) </span><span style="color:#ccc9c2cc;">-&gt; </span><span style="font-style:italic;color:#5ccfe6;">Result</span><span>&lt;Json&lt;User&gt;, Error&gt; {
</span><span>    </span><span style="font-style:italic;color:#5ccfe6;">Ok</span><span>(body)
</span><span>}
</span></code></pre>
<p>You can see, that the <code>User</code> type has to be repeated in both the <code>request_body</code> and <code>body</code> attributes. This could potentially mean that the generated OpenAPI specification does not match reality, so extra care is needed to ensure they match.</p>
<p>It would be nice if the proc macro could work this out by itself rather than having to redefine them in attributes, but it would require tighter integration, something that might be added in the future.</p>
<p>Generating a OpenAPI JSON file is a little bit easier than in paperclip.</p>
<p>Firstly you combine all your components on a struct:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">derive</span><span>(OpenApi)]
</span><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">openapi</span><span>(</span><span style="color:#ffd580;">components</span><span>(</span><span style="color:#ffd580;">schemas</span><span>(User))</span><span style="color:#ccc9c2cc;">, </span><span style="color:#ffd580;">paths</span><span>(echo_user))]
</span><span style="color:#ffa759;">struct </span><span style="color:#73d0ff;">ApiDoc</span><span style="color:#ccc9c2cc;">;
</span></code></pre>
<p>Then you can use some standard methods to write it out:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span>std</span><span style="color:#f29e74;">::</span><span>fs</span><span style="color:#f29e74;">::</span><span>write(
</span><span>    </span><span style="color:#bae67e;">&quot;openapi.json&quot;</span><span style="color:#ccc9c2cc;">,
</span><span>    </span><span style="color:#f29e74;">&amp;</span><span>ApiDoc</span><span style="color:#f29e74;">::</span><span>openapi()
</span><span>        </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">to_pretty_json</span><span>()
</span><span>        </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">expect</span><span>(</span><span style="color:#bae67e;">&quot;Should serialize&quot;</span><span>)</span><span style="color:#ccc9c2cc;">,
</span><span>)</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
</span></code></pre>
<h3 id="typescript-from-openapi">TypeScript from OpenAPI</h3>
<p>With an <code>openapi.json</code> file you can use a tool such as <code>openapi-generator-cli</code> to generate the requisite definitions:</p>
<pre style="background-color:#212733;color:#ccc9c2;"><code><span>npx openapi-generator-cli generate -i openapi.json -g typescript
</span></code></pre>
<p>This won't create purely typescript definitions, as there still needs to be a library to make requests and you may want to generate types closer to your frontend framework like using <code>typescript-rxjs</code> etc...</p>
<p>Normally this isn't run individually, but rather it is included inside <code>package.json</code> of an existing frontend project.</p>
<h2 id="graphql">GraphQL</h2>
<p><a href="https://www.graphql.com/">GraphQL</a> <em>can</em> be used to publish types, albeit indirectly and does require you to modify your backend to support it. The types that can be represented in GraphQL are also quite restricted: <a href="https://github.com/graphql/graphql-spec/issues/91">no recursive types</a>, <a href="https://stackoverflow.com/questions/41515679/can-you-make-a-graphql-type-both-an-input-and-output-type">no shared types between input/output</a>, <a href="https://github.com/graphql/graphql-spec/pull/395">incomplete support for sum-types/unions</a> to name a few issues I've personally hit using it. If you're happy with the high level of opinionation GraphQL forces upon your code base, you are rewarded with some great tooling &amp; infrastructure.</p>
<p>The main two libraries for GraphQL on the backend are <a href="https://github.com/async-graphql/async-graphql"><code>async-graphql</code></a> and <a href="https://github.com/graphql-rust/juniper"><code>juniper</code></a>.</p>
<p>On the frontend, there is <a href="https://www.the-guild.dev/graphql/codegen/docs/getting-started">similar tooling</a> to OpenAPI for generating types &amp; requests. You will, however, need to also write out some specific GraphQL queries, to utilise them.</p>
<h3 id="async-graphql">async-graphql</h3>
<p>As with the Derive Macro &amp; OpenAPI generators you start by decorating your structs. We can use the <code>SimpleObject</code> and <code>InputObject</code> derive macros (in GraphQL you need separate types for input...):</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">derive</span><span>(Serialize</span><span style="color:#ccc9c2cc;">,</span><span> Deserialize</span><span style="color:#ccc9c2cc;">,</span><span> SimpleObject)]
</span><span style="color:#ffa759;">struct </span><span style="color:#73d0ff;">User </span><span>{
</span><span>    user_id</span><span style="color:#ccc9c2cc;">: </span><span style="color:#ffa759;">i32</span><span>,
</span><span>    first_name</span><span style="color:#ccc9c2cc;">:</span><span> String,
</span><span>    last_name</span><span style="color:#ccc9c2cc;">:</span><span> String,
</span><span>}
</span><span>
</span><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">derive</span><span>(Serialize</span><span style="color:#ccc9c2cc;">,</span><span> Deserialize</span><span style="color:#ccc9c2cc;">,</span><span> InputObject)]
</span><span style="color:#ffa759;">struct </span><span style="color:#73d0ff;">UserInput </span><span>{
</span><span>    user_id</span><span style="color:#ccc9c2cc;">: </span><span style="color:#ffa759;">i32</span><span>,
</span><span>    first_name</span><span style="color:#ccc9c2cc;">:</span><span> String,
</span><span>    last_name</span><span style="color:#ccc9c2cc;">:</span><span> String,
</span><span>}
</span></code></pre>
<p>Next, we want to define a <code>Query</code> object which will dictate the methods available via GraphQL:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ffa759;">pub struct </span><span style="color:#73d0ff;">Query</span><span style="color:#ccc9c2cc;">;
</span><span>
</span><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">Object</span><span>]
</span><span style="color:#ffa759;">impl </span><span style="color:#73d0ff;">Query </span><span>{
</span><span>    async </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">echo_user</span><span>(</span><span style="color:#f29e74;">&amp;</span><span style="color:#ffcc66;">self</span><span>, </span><span style="color:#ffcc66;">user</span><span style="color:#ccc9c2cc;">:</span><span> UserInput) </span><span style="color:#ccc9c2cc;">-&gt;</span><span> User {
</span><span>        User {
</span><span>            user_id</span><span style="color:#ccc9c2cc;">:</span><span> user</span><span style="color:#f29e74;">.</span><span>user_id</span><span style="color:#ccc9c2cc;">,
</span><span>            first_name</span><span style="color:#ccc9c2cc;">:</span><span> user</span><span style="color:#f29e74;">.</span><span>first_name</span><span style="color:#ccc9c2cc;">,
</span><span>            last_name</span><span style="color:#ccc9c2cc;">:</span><span> user</span><span style="color:#f29e74;">.</span><span>last_name</span><span style="color:#ccc9c2cc;">,
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre>
<p>Then we can set up a handler for graphql queries (leaving subscriptions and mutations empty for now):</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span>async </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">graphql_handler</span><span>(
</span><span>    </span><span style="color:#ffcc66;">schema</span><span style="color:#ccc9c2cc;">: </span><span>web</span><span style="color:#f29e74;">::</span><span>Data&lt;Schema&lt;Query, EmptyMutation, EmptySubscription&gt;&gt;,
</span><span>    </span><span style="color:#ffcc66;">request</span><span style="color:#ccc9c2cc;">:</span><span> GraphQLRequest,
</span><span>) </span><span style="color:#ccc9c2cc;">-&gt;</span><span> GraphQLResponse {
</span><span>    schema</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">execute</span><span>(request</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">into_inner</span><span>())</span><span style="color:#f29e74;">.</span><span>await</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">into</span><span>()
</span><span>}
</span></code></pre>
<p>And a <a href="https://github.com/graphql/graphiql">GraphiQL</a> endpoint to use a browser to craft graphql queries:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span>async </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">graphql_playground</span><span>() </span><span style="color:#ccc9c2cc;">-&gt;</span><span> HttpResponse {
</span><span>    HttpResponse</span><span style="color:#f29e74;">::</span><span>Ok()
</span><span>        </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">content_type</span><span>(</span><span style="color:#bae67e;">&quot;text/html; charset=utf-8&quot;</span><span>)
</span><span>        </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">body</span><span>(GraphiQLSource</span><span style="color:#f29e74;">::</span><span>build()</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">endpoint</span><span>(</span><span style="color:#bae67e;">&quot;/graphql&quot;</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">finish</span><span>())
</span><span>}
</span></code></pre>
<p>We wrap the schema in <code>web::Data</code> and add it as <code>app_data</code>, then provide our two new services:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">actix_web</span><span>::</span><span style="color:#ffd580;">main</span><span>]
</span><span>async </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">main</span><span>() </span><span style="color:#ccc9c2cc;">-&gt; </span><span>std</span><span style="color:#f29e74;">::</span><span>io</span><span style="color:#f29e74;">::</span><span style="font-style:italic;color:#5ccfe6;">Result</span><span>&lt;()&gt; {
</span><span>    </span><span style="color:#ffa759;">let</span><span> schema </span><span style="color:#f29e74;">= </span><span>Schema</span><span style="color:#f29e74;">::</span><span>build(Query</span><span style="color:#ccc9c2cc;">,</span><span> EmptyMutation</span><span style="color:#ccc9c2cc;">,</span><span> EmptySubscription)</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">finish</span><span>()</span><span style="color:#ccc9c2cc;">;
</span><span>    </span><span style="color:#ffa759;">let</span><span> schema_data </span><span style="color:#f29e74;">= </span><span>web</span><span style="color:#f29e74;">::</span><span>Data</span><span style="color:#f29e74;">::</span><span>new(schema)</span><span style="color:#ccc9c2cc;">;
</span><span>
</span><span>    HttpServer</span><span style="color:#f29e74;">::</span><span>new(</span><span style="color:#ffa759;">move </span><span style="color:#f29e74;">|| </span><span>{
</span><span>        App</span><span style="color:#f29e74;">::</span><span>new()
</span><span>            </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">app_data</span><span>(schema_data</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">clone</span><span>())
</span><span>            </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">service</span><span>(web</span><span style="color:#f29e74;">::</span><span>resource(</span><span style="color:#bae67e;">&quot;/graphql&quot;</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">route</span><span>(web</span><span style="color:#f29e74;">::</span><span>post()</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">to</span><span>(graphql_handler)))
</span><span>            </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">service</span><span>(web</span><span style="color:#f29e74;">::</span><span>resource(</span><span style="color:#bae67e;">&quot;/playground&quot;</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">route</span><span>(web</span><span style="color:#f29e74;">::</span><span>get()</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">to</span><span>(graphql_playground)))
</span><span>    })
</span><span>    </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">bind</span><span>(</span><span style="color:#bae67e;">&quot;127.0.0.1:8080&quot;</span><span>)</span><span style="color:#f29e74;">?
</span><span>    </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">run</span><span>()
</span><span>    </span><span style="color:#f29e74;">.</span><span>await
</span><span>}
</span></code></pre>
<p>You can also write out the schema via the <code>sdl()</code> method on <code>Schema</code>:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span>std</span><span style="color:#f29e74;">::</span><span>fs</span><span style="color:#f29e74;">::</span><span>write(</span><span style="color:#bae67e;">&quot;example.graphql&quot;</span><span style="color:#ccc9c2cc;">,</span><span> schema</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">sdl</span><span>())</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
</span></code></pre>
<h4 id="graphiql-playground">GraphiQL Playground</h4>
<p>Navigating to <code>http://localhost:8080/playground</code> in a browser you will get the <a href="https://github.com/graphql/graphiql">GraphiQL playground</a>:</p>
<p><a href="/photos/graphiql.png"><img src="/photos/graphiql.png" alt="" /></a></p>
<h3 id="juniper">juniper</h3>
<p>The <a href="https://github.com/graphql-rust/juniper"><code>juniper</code></a> crate in this context is very similar to <a href="https://github.com/async-graphql/async-graphql"><code>async-graphql</code></a>.</p>
<p><code>juniper</code> as a crate has been around a fair bit longer <code>async-graphql</code> &amp; did not start off as an async library. Both are very capable libraries, but I have found <code>async-graphql</code> to be better documented, and more &quot;modern&quot;.</p>
<p>In terms of coding for our example, <code>juniper</code> is very similar to <code>async-graphql</code>, with derive macros on the types you want to define:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">derive</span><span>(Serialize</span><span style="color:#ccc9c2cc;">,</span><span> Deserialize</span><span style="color:#ccc9c2cc;">,</span><span> GraphQLObject)]
</span><span style="color:#ffa759;">struct </span><span style="color:#73d0ff;">User </span><span>{
</span><span>    user_id</span><span style="color:#ccc9c2cc;">: </span><span style="color:#ffa759;">i32</span><span>,
</span><span>    first_name</span><span style="color:#ccc9c2cc;">:</span><span> String,
</span><span>    last_name</span><span style="color:#ccc9c2cc;">:</span><span> String,
</span><span>}
</span><span>
</span><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">derive</span><span>(Serialize</span><span style="color:#ccc9c2cc;">,</span><span> Deserialize</span><span style="color:#ccc9c2cc;">,</span><span> GraphQLInputObject)]
</span><span style="color:#ffa759;">struct </span><span style="color:#73d0ff;">UserInput </span><span>{
</span><span>    user_id</span><span style="color:#ccc9c2cc;">: </span><span style="color:#ffa759;">i32</span><span>,
</span><span>    first_name</span><span style="color:#ccc9c2cc;">:</span><span> String,
</span><span>    last_name</span><span style="color:#ccc9c2cc;">:</span><span> String,
</span><span>}
</span><span>
</span></code></pre>
<p>The query object is also very much a slot in:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ffa759;">pub struct </span><span style="color:#73d0ff;">Query</span><span style="color:#ccc9c2cc;">;
</span><span>
</span><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">juniper</span><span>::</span><span style="color:#ffd580;">graphql_object</span><span>]
</span><span style="color:#ffa759;">impl </span><span style="color:#73d0ff;">Query </span><span>{
</span><span>    async </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">echo_user</span><span>(</span><span style="color:#f29e74;">&amp;</span><span style="color:#ffcc66;">self</span><span>, </span><span style="color:#ffcc66;">user</span><span style="color:#ccc9c2cc;">:</span><span> UserInput) </span><span style="color:#ccc9c2cc;">-&gt;</span><span> User {
</span><span>        User {
</span><span>            user_id</span><span style="color:#ccc9c2cc;">:</span><span> user</span><span style="color:#f29e74;">.</span><span>user_id</span><span style="color:#ccc9c2cc;">,
</span><span>            first_name</span><span style="color:#ccc9c2cc;">:</span><span> user</span><span style="color:#f29e74;">.</span><span>first_name</span><span style="color:#ccc9c2cc;">,
</span><span>            last_name</span><span style="color:#ccc9c2cc;">:</span><span> user</span><span style="color:#f29e74;">.</span><span>last_name</span><span style="color:#ccc9c2cc;">,
</span><span>        }
</span><span>    }
</span><span>}
</span></code></pre>
<p>Creating the schema is also similar:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ffa759;">let</span><span> schema </span><span style="color:#f29e74;">= </span><span>Schema</span><span style="color:#f29e74;">::</span><span>new(Query</span><span style="color:#ccc9c2cc;">, </span><span>EmptyMutation</span><span style="color:#f29e74;">::</span><span>new()</span><span style="color:#ccc9c2cc;">, </span><span>EmptySubscription</span><span style="color:#f29e74;">::</span><span>new())</span><span style="color:#ccc9c2cc;">;
</span></code></pre>
<p>The handler method deviates slightly, but is mostly the same as above:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span>async </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">graphql</span><span>(
</span><span>    </span><span style="color:#ffcc66;">req</span><span style="color:#ccc9c2cc;">: </span><span>actix_web</span><span style="color:#f29e74;">::</span><span>HttpRequest,
</span><span>    </span><span style="color:#ffcc66;">payload</span><span style="color:#ccc9c2cc;">: </span><span>actix_web</span><span style="color:#f29e74;">::</span><span>web</span><span style="color:#f29e74;">::</span><span>Payload,
</span><span>    </span><span style="color:#ffcc66;">schema</span><span style="color:#ccc9c2cc;">: </span><span>web</span><span style="color:#f29e74;">::</span><span>Data&lt;Schema&gt;,
</span><span>) </span><span style="color:#ccc9c2cc;">-&gt; </span><span style="font-style:italic;color:#5ccfe6;">Result</span><span>&lt;HttpResponse, Error&gt; {
</span><span>    </span><span style="color:#f28779;">graphql_handler</span><span>(</span><span style="color:#f29e74;">&amp;</span><span>schema</span><span style="color:#ccc9c2cc;">, </span><span style="color:#f29e74;">&amp;</span><span>()</span><span style="color:#ccc9c2cc;">,</span><span> req</span><span style="color:#ccc9c2cc;">,</span><span> payload)</span><span style="color:#f29e74;">.</span><span>await
</span><span>}
</span></code></pre>
<p>The <code>juniper_actix</code> integration also provides a <code>graphiql_handler</code> which you can use to mount the playground (<code>v1</code> of <code>graphiql</code> instead of <code>v2</code> at this time of writing).</p>
<p>Putting this together, we get almost an identical layout:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span style="color:#ccc9c2cc;">#</span><span>[</span><span style="color:#ffd580;">actix_web</span><span>::</span><span style="color:#ffd580;">main</span><span>]
</span><span>async </span><span style="color:#ffa759;">fn </span><span style="color:#ffd580;">main</span><span>() </span><span style="color:#ccc9c2cc;">-&gt; </span><span>std</span><span style="color:#f29e74;">::</span><span>io</span><span style="color:#f29e74;">::</span><span style="font-style:italic;color:#5ccfe6;">Result</span><span>&lt;()&gt; {
</span><span>    </span><span style="color:#ffa759;">let</span><span> schema </span><span style="color:#f29e74;">= </span><span>Schema</span><span style="color:#f29e74;">::</span><span>new(Query</span><span style="color:#ccc9c2cc;">, </span><span>EmptyMutation</span><span style="color:#f29e74;">::</span><span>new()</span><span style="color:#ccc9c2cc;">, </span><span>EmptySubscription</span><span style="color:#f29e74;">::</span><span>new())</span><span style="color:#ccc9c2cc;">;
</span><span>    </span><span style="color:#ffa759;">let</span><span> schema_data </span><span style="color:#f29e74;">= </span><span>web</span><span style="color:#f29e74;">::</span><span>Data</span><span style="color:#f29e74;">::</span><span>new(schema)</span><span style="color:#ccc9c2cc;">;
</span><span>
</span><span>    HttpServer</span><span style="color:#f29e74;">::</span><span>new(</span><span style="color:#ffa759;">move </span><span style="color:#f29e74;">|| </span><span>{
</span><span>        App</span><span style="color:#f29e74;">::</span><span>new()
</span><span>            </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">app_data</span><span>(schema_data</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">clone</span><span>())
</span><span>            </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">service</span><span>(web</span><span style="color:#f29e74;">::</span><span>resource(</span><span style="color:#bae67e;">&quot;/graphql&quot;</span><span>)</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">route</span><span>(web</span><span style="color:#f29e74;">::</span><span>post()</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">to</span><span>(graphql)))
</span><span>            </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">service</span><span>(
</span><span>                web</span><span style="color:#f29e74;">::</span><span>resource(</span><span style="color:#bae67e;">&quot;/playground&quot;</span><span>)
</span><span>                    </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">route</span><span>(web</span><span style="color:#f29e74;">::</span><span>get()</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">to</span><span>(|| </span><span style="color:#f28779;">graphiql_handler</span><span>(</span><span style="color:#bae67e;">&quot;/graphql&quot;</span><span style="color:#ccc9c2cc;">, </span><span style="font-style:italic;color:#5ccfe6;">None</span><span>)))</span><span style="color:#ccc9c2cc;">,
</span><span>            )
</span><span>    })
</span><span>    </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">bind</span><span>(</span><span style="color:#bae67e;">&quot;127.0.0.1:8080&quot;</span><span>)</span><span style="color:#f29e74;">?
</span><span>    </span><span style="color:#f29e74;">.</span><span style="color:#f28779;">run</span><span>()
</span><span>    </span><span style="color:#f29e74;">.</span><span>await
</span><span>}
</span></code></pre>
<p>As with <code>async-graphql</code> the graphql schema can be written out to disk using the <code>as_schema_language()</code> method:</p>
<pre data-lang="rust" style="background-color:#212733;color:#ccc9c2;" class="language-rust "><code class="language-rust" data-lang="rust"><span>std</span><span style="color:#f29e74;">::</span><span>fs</span><span style="color:#f29e74;">::</span><span>write(</span><span style="color:#bae67e;">&quot;example.graphql&quot;</span><span style="color:#ccc9c2cc;">,</span><span> schema</span><span style="color:#f29e74;">.</span><span style="color:#f28779;">as_schema_language</span><span>())</span><span style="color:#f29e74;">?</span><span style="color:#ccc9c2cc;">;
</span></code></pre>
<h3 id="graphql-to-typescript">GraphQL to TypeScript</h3>
<p>Now, the next question is: we have our graphql schema, how do we get to typescript definitions? The easiest way I've found, from a maintenance perspective, is a little bit involved for this particular blog. The gist is that using <a href="https://www.the-guild.dev/graphql/codegen/docs/getting-started"><code>GraphQL Code Generator</code></a> you can define your queries and then have frontend methods/types generated from them.</p>
<p>This does require a bit of scaffolding in your frontend project to get working, but is rather painless when it is set up, besides having to write queries/mutations for all of your types.</p>
<h2 id="conclusions">Conclusions</h2>
<p>As you can see there are a variety of ways of publishing rust types for use within <code>TypeScript</code>. Having this process is as automated as possible is a great way to icnrease cohesion between front &amp; backend. Whether these methods are right for you depends entirely on your use-case &amp; what tradeoffs you're willing to make:</p>
<p><strong>Types Only</strong>: You can use direct translation tools such as <a href="https://crates.io/crates/ts-rs"><code>ts-rs</code></a> or <a href="https://crates.io/crates/schemars"><code>schemars</code></a></p>
<p><strong>OpenAPI</strong>: You can go the OpenAPI route using <a href="https://crates.io/crates/paperclip"><code>paperclip</code></a> or <a href="https://crates.io/crates/utoipa"><code>utoipa</code></a></p>
<p><strong>GraphQL</strong>: You can use GraphQL with <a href="https://github.com/async-graphql/async-graphql"><code>async-graphql</code></a> or <a href="https://github.com/graphql-rust/juniper"><code>juniper</code></a></p>
<p>When building <a href="https://divedb.net/">DiveDB</a>, I opted to use GraphQL due to its great frontend tooling &amp; standardised introspection. In future blogs I hope to dive into some of the details of this decision.</p>

  </section>
</article>


    </div>
</body>

</html>